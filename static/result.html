<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊàëÁöÑ IG Â∏≥ËôüÂÉπÂÄºÂ†±Âëä</title>
  <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

    body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
            padding: 20px;
      display: flex;
            justify-content: center;
      align-items: center;
    }
    
    .container {
            max-width: 500px;
            width: 100%;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 30px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
        }

        /* Â∏≥ËôüË≥áË®äÂçÄÂüü */
        .account-info {
            padding: 20px 30px 10px;
            text-align: left;
            margin: 20px 30px 0;
        }

        .username {
            color: #333;
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 8px;
        }
    
        .username::before {
            content: '@';
            opacity: 0.8;
        }

        .display-name {
            color: #666;
            font-size: 16px;
            font-weight: 500;
        }

        /* Á§æÁæ§ÂÆö‰ΩçÂç°Áâá */
        .personality-card {
            background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 10px 30px 20px;
            color: white;
            box-shadow: 0 15px 35px rgba(240, 148, 51, 0.3);
            position: relative;
            overflow: hidden;
            text-align: center;
        }

        .personality-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .badge {
            background: rgba(255, 255, 255, 0.25);
            border: 1px solid rgba(255, 255, 255, 0.4);
            color: white;
            font-size: 14px;
            padding: 8px 16px;
            border-radius: 15px;
            font-weight: 600;
            margin-bottom: 25px;
            display: inline-block;
            position: relative;
            z-index: 1;
        }

        .personality-info {
            color: white;
            font-size: 16px;
            position: relative;
            z-index: 1;
        }

        .personality-name {
            font-weight: 700;
            margin-bottom: 2px;
            font-size: 18px;
        }

        .personality-en {
            font-size: 12px;
            opacity: 0.8;
            font-style: italic;
        }

        /* Êï∏ÊìöÁµ±Ë®àÂçÄÂüü */
        .stats-section {
            display: flex;
            justify-content: center;
            gap: 40px;
            padding: 30px;
            margin: 20px 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-weight: 800;
            font-size: 24px;
            color: #333;
            display: block;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
            font-weight: 500;
        }

        /* ‰∏ªË¶ÅÂÉπÂÄºÂ±ïÁ§∫ÂçÄ */
        .value-section {
            padding: 40px 30px 30px;
            text-align: center;
            background: linear-gradient(180deg, #fff 0%, #fafafa 100%);
        }

        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .value-title {
            font-size: 16px;
            color: #666;
            margin-bottom: 15px;
      font-weight: 500;
    }
    
        .total-value {
            font-size: 64px;
      font-weight: 800;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            margin-bottom: 10px;
            animation: valueAppear 0.8s ease-out;
        }

        @keyframes valueAppear {
            0% {
                opacity: 0;
                transform: scale(0.5);
            }
            60% {
                transform: scale(1.1);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .value-subtitle {
            font-size: 14px;
            color: #999;
            margin-bottom: 25px;
        }



        /* AI ÂàÜÊûêÊñáÂ≠óÂçÄÂ°äÔºàÊñ∞Â¢ûÔºâ*/
        .analysis-section {
            padding: 25px 30px;
            background: white;
        }

        .analysis-title {
      font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .analysis-text {
            font-size: 14px;
            line-height: 1.8;
      color: #555;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #667eea;
        }

        .analysis-text p {
            margin-bottom: 15px;
        }

        .analysis-text p:last-child {
            margin-bottom: 0;
        }

        /* Âêà‰ΩúÂ†±ÂÉπÂçÄÂ°ä */
        .pricing-section {
            padding: 25px 30px;
            background: linear-gradient(180deg, #fafafa 0%, #f5f5f5 100%);
            border-radius: 20px;
            margin: 20px 0 25px;
        }

        .pricing-title {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .pricing-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .price-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px 15px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .price-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .price-type {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            font-weight: 600;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .price-value {
      font-size: 20px;
      font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ‰øÇÊï∏Â±ïÁ§∫ */
        .multipliers-section {
            padding: 25px 30px;
            background: #fafafa;
        }

        .multipliers-title {
            font-size: 16px;
            font-weight: 700;
      color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .multiplier-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .multiplier-item {
            background: white;
            border-radius: 12px;
            padding: 12px;
      display: flex;
            justify-content: space-between;
      align-items: center;
            border: 1px solid #f0f0f0;
        }

        .multiplier-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .multiplier-value {
            font-size: 16px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ÊèêÂçáÂª∫Ë≠∞ */
        .tips-section {
            padding: 25px 30px;
            background: white;
        }

        .tips-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .tip-item {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 10px;
      font-size: 13px;
      color: #555;
            line-height: 1.5;
        }

        .tip-item::before {
            content: 'üí° ';
            margin-right: 5px;
        }

        /* ÂàÜ‰∫´ÊåâÈàï */
        .share-section {
            padding: 25px 30px 35px;
            text-align: center;
            background: white;
        }

        .share-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
            padding: 15px 40px;
            border-radius: 25px;
      font-size: 16px;
            font-weight: 700;
      cursor: pointer;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .share-button:hover {
      transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.5);
        }

        .share-button:active {
            transform: translateY(0);
        }

        /* Â∫ïÈÉ®ÁΩ≤Âêç */
        .footer {
            padding: 20px;
            text-align: center;
            background: #f5f5f5;
            font-size: 11px;
            color: #999;
        }

        /* ÈüøÊáâÂºèË®≠Ë®à */
        @media (max-width: 768px) {
            .account-info,
            .personality-card,
            .stats-section {
                margin: 10px 15px;
            }

            .account-info {
                padding: 15px 20px 5px;
            }

            .stats-section {
                gap: 15px;
            }

            .value-section {
                padding: 20px 15px 15px;
            }

            .total-value {
                font-size: 48px;
            }

            .pricing-section {
                margin: 10px 15px;
                padding: 15px;
            }

            .pricing-cards {
                gap: 10px;
            }

            .price-card {
                padding: 15px 10px;
            }

            .price-value {
                font-size: 16px;
            }

            .multipliers-section {
                padding: 15px;
            }

            .tips-section {
                padding: 15px;
            }

            .share-section {
                padding: 15px 15px 20px;
            }
        }

        @media (max-width: 480px) {
            .container {
                border-radius: 0;
                box-shadow: none;
                min-height: 100vh;
                padding: 5px;
                max-height: 100vh;
                overflow-y: auto;
            }

            .account-info,
            .personality-card,
            .stats-section {
                margin: 5px 8px;
            }

            .account-info {
                padding: 8px 12px 3px;
            }

            .personality-card,
            .stats-section {
                padding: 12px;
            }

            .stats-section {
                flex-direction: row;
                justify-content: space-around;
                gap: 8px;
            }

            .stat-item {
                flex: 1;
                padding: 8px 4px;
            }

            .stat-number {
                font-size: 16px;
            }

            .stat-label {
                font-size: 10px;
            }

            .username {
                font-size: 20px;
            }

            .value-section {
                padding: 10px 8px 5px;
            }

            .value-title {
                font-size: 12px;
                margin-bottom: 5px;
            }

            .total-value {
                font-size: 28px;
                margin-bottom: 3px;
            }

            .value-subtitle {
                font-size: 10px;
                margin-bottom: 8px;
            }

            .pricing-section {
                margin: 5px 8px;
                padding: 8px;
            }

            .pricing-title {
                font-size: 12px;
                margin-bottom: 8px;
            }

            .pricing-cards {
                grid-template-columns: 1fr;
                gap: 6px;
            }

            .price-card {
                padding: 8px 6px;
            }

            .price-type {
                font-size: 9px;
                margin-bottom: 4px;
            }

            .price-value {
                font-size: 12px;
            }

            .multipliers-section {
                padding: 8px;
            }

            .multipliers-title {
                font-size: 12px;
                margin-bottom: 6px;
            }

            .multiplier-grid {
                grid-template-columns: 1fr;
                gap: 4px;
            }

            .multiplier-item {
                padding: 6px;
            }

            .multiplier-label {
                font-size: 10px;
            }

            .tips-section {
                padding: 8px;
            }

            .tips-title {
                font-size: 12px;
                margin-bottom: 6px;
            }

            .tip-item {
                font-size: 10px;
                padding: 6px 8px;
                margin-bottom: 4px;
            }

            .share-section {
                padding: 8px 8px 10px;
            }

            .share-button {
                padding: 10px 20px;
                font-size: 14px;
            }
        }

        /* Loading ÂãïÁï´ */
        .loading {
            text-align: center;
            padding: 60px 30px;
            color: white;
            position: relative;
        }

        .loading-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            padding: 50px 40px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            max-width: 400px;
            margin: 0 auto;
        }

        .loading-title {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .loading-subtitle {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 30px;
        }

        .loading-spinner {
            width: 60px;
            height: 60px;
            margin: 0 auto 30px;
            position: relative;
        }

        .spinner-ring {
            width: 100%;
            height: 100%;
            border: 3px solid rgba(255, 255, 255, 0.2);
            border-top: 3px solid #f09433;
            border-right: 3px solid #e6683c;
            border-radius: 50%;
            animation: spin 1.2s linear infinite;
        }

        .spinner-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background: linear-gradient(45deg, #f09433, #e6683c);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0%, 100% { 
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
            50% { 
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 0.7;
            }
        }

        .loading-progress {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .loading-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            border-radius: 2px;
            animation: progress 3s ease-in-out infinite;
        }

        @keyframes progress {
            0% { width: 0%; }
            50% { width: 70%; }
            100% { width: 100%; }
        }

        .loading-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            font-size: 12px;
            opacity: 0.7;
        }

        .loading-step {
            flex: 1;
            text-align: center;
            padding: 5px;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .loading-step.active {
            background: rgba(255, 255, 255, 0.1);
            opacity: 1;
        }

        .hidden {
            display: none;
    }
  </style>
</head>
<body>
    <div class="container">
        <!-- Loading ÁãÄÊÖã -->
        <div id="loading" class="loading">
            <div class="loading-container">
                <div class="loading-title">IG Â∏≥ËôüÂÉπÂÄºÂàÜÊûê</div>
                <div class="loading-subtitle">AI Ê≠£Âú®Ê∑±Â∫¶ÂàÜÊûêÊÇ®ÁöÑÁ§æÁæ§ÂΩ±ÈüøÂäõ...</div>
                
                <div class="loading-spinner">
                    <div class="spinner-ring"></div>
                    <div class="spinner-dot"></div>
                </div>
                
                <div class="loading-progress">
                    <div class="loading-progress-bar"></div>
                </div>
                
                <div class="loading-steps">
                    <div class="loading-step active">ÂàÜÊûê‰∏≠</div>
                    <div class="loading-step">Ë®àÁÆóÂÉπÂÄº</div>
                    <div class="loading-step">ÁîüÊàêÂ†±Âëä</div>
                </div>
            </div>
        </div>
    
        <!-- ÁµêÊûúÂ±ïÁ§∫ÔºàÈ†êË®≠Èö±ËóèÔºâ -->
        <div id="result" class="hidden">
            <!-- Â∏≥ËôüË≥áË®äÂçÄÂüü -->
            <div class="account-info">
                <div class="username" id="username">username</div>
                <div class="display-name" id="display-name">Âè∞ÂåóÁæéÈ£üÊé¢Á¥¢ËÄÖ</div>
            </div>
            
            <!-- Á§æÁæ§ÂÆö‰ΩçÂç°Áâá -->
            <div class="personality-card">
                <div class="badge" id="follower-tier">ÊÑèË¶ãÈ†òË¢ñ</div>
                <div class="personality-info">
                    <div class="personality-name" id="personality-name">ÁîüÊ¥ªË®òÈåÑËÄÖ</div>
                    <div class="personality-en" id="personality-en">Everyday Chronicler</div>
                </div>
            </div>
            
            <!-- Êï∏ÊìöÁµ±Ë®àÂçÄÂüü -->
            <div class="stats-section">
                <div class="stat-item">
                    <span class="stat-number" id="followers">0</span>
                    <span class="stat-label">Á≤âÁµ≤</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="following">0</span>
                    <span class="stat-label">ËøΩËπ§</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" id="posts">0</span>
                    <span class="stat-label">Ë≤ºÊñá</span>
                </div>
            </div>
    
            <!-- ‰∏ªË¶ÅÂÉπÂÄºÂ±ïÁ§∫ -->
            <div class="value-section">
                <div class="value-title">‰Ω†ÁöÑÂ∏≥ËôüÁ∏ΩÂÉπÂÄº</div>
                <div class="total-value" id="total-value">NT$ 0</div>
                <div class="value-subtitle">Âü∫Êñº AI Â§öÁ∂≠Â∫¶ÂàÜÊûê (Êú¨ÂàÜÊûêÁµêÊûúÂÉÖ‰æõÂ®õÊ®ÇÊÄßË≥™ÂèÉËÄÉ)</div>
                
                <!-- Âêà‰ΩúÂ†±ÂÉπÔºàÊï¥ÂêàÂà∞ÂÉπÂÄºÂ±ïÁ§∫ÂçÄÔºâ -->
                <div class="pricing-section">
                    <div class="pricing-title">üí∞ Âêà‰ΩúÂ†±ÂÉπÂèÉËÄÉ</div>
                    <div class="pricing-cards">
                        <div class="price-card">
                            <div class="price-type">Ë≤ºÊñá</div>
                            <div class="price-value" id="post-value">NT$ 0</div>
              </div>
                        <div class="price-card">
                            <div class="price-type">ÈôêÂãï</div>
                            <div class="price-value" id="story-value">NT$ 0</div>
              </div>
                        <div class="price-card">
                            <div class="price-type">Áü≠ÂΩ±Èü≥</div>
                            <div class="price-value" id="reels-value">NT$ 0</div>
            </div>
          </div>
        </div>
                
        
            <!-- AI Â∞àÊ•≠ÂàÜÊûêÔºàÊñ∞Â¢ûÔºåÂÉÖÁï∂Êúâ analysis_text ÊôÇÈ°ØÁ§∫Ôºâ-->
            <div class="analysis-section" id="analysis-section" style="display:none;">
                <div class="analysis-title">üíº Â∞àÊ•≠ IG Á§æÁæ§Â∏≥ËôüÂÉπÂÄºÂàÜÊûê</div>
                <div class="analysis-text" id="analysis-text"></div>
        </div>
    
            <!-- ‰øÇÊï∏Â±ïÁ§∫ -->
            <div class="multipliers-section">
                <div class="multipliers-title">üìä ÂÉπÂÄºÂèÉËÄÉÁ∂≠Â∫¶</div>
                <div class="multiplier-grid" id="multipliers-grid">
                    <!-- Â∞áÁî± JS ÂãïÊÖãÁîüÊàê -->
      </div>
                <div style="text-align: center; margin-top: 15px;">
                    <button id="learn-more-btn" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 8px 20px; border-radius: 20px; font-size: 12px; cursor: pointer; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);" onclick="showMultiplierDetails()">‰∫ÜËß£Êõ¥Â§ö</button>
                </div>
    </div>

            <!-- ÊèêÂçáÂª∫Ë≠∞ -->
            <div class="tips-section">
                <div class="tips-title">üí° ÂÉπÂÄºÊèêÂçáÂª∫Ë≠∞</div>
                <div id="tips-container">
                    <!-- Â∞áÁî± JS ÂãïÊÖãÁîüÊàê -->
      </div>
    </div>

            <!-- ÂàÜ‰∫´ÊåâÈàï -->
            <div class="share-section">
                <button class="share-button" onclick="shareResult()">
                    <span>üì∏</span>
                    <span>ÂàÜ‰∫´ÊàëÁöÑÂ∏≥ËôüÂÉπÂÄº</span>
                </button>
    </div>

            <!-- Â∫ïÈÉ® -->
            <div class="footer">
                Powered by IG Value Estimation System V5
    </div>
      </div>
    </div>

    <script>
        // Ê†ºÂºèÂåñÊï∏Â≠óÔºàIGÂÆòÊñπÊ†ºÂºèÔºö10K, 1MÁ≠âÔºâ
        function formatNumber(num) {
            // Â¶ÇÊûúÂ∑≤Á∂ìÊòØÂ≠óÁ¨¶‰∏≤‰∏îÂåÖÂê´K/MÔºåÁõ¥Êé•ËøîÂõû
            if (typeof num === 'string' && (num.includes('K') || num.includes('M'))) {
                return num;
            }
            
            // ËΩâÊèõÁÇ∫Êï∏Â≠óÈÄ≤Ë°åËôïÁêÜ
            const numValue = typeof num === 'string' ? parseFloat(num) : num;
            
            if (numValue >= 1000000) {
                return (numValue / 1000000).toFixed(1) + 'M';
            } else if (numValue >= 10000) {
                return (numValue / 1000).toFixed(1) + 'K';
            }
            return numValue.toString();
        }

        // Ê†ºÂºèÂåñÈáëÈ°ç
        function formatPrice(price) {
            if (price >= 10000) {
                return `NT$ ${(price / 10000).toFixed(1)}Ëê¨`;
            }
            return `NT$ ${formatNumber(price)}`;
        }

        // ‰øÇÊï∏Ê®ôÁ±§Êò†Â∞Ñ
        const multiplierLabels = {
            'visual': 'Ë¶ñË¶∫ÂìÅË≥™',
            'content': 'ÂÖßÂÆπÂÆö‰Ωç',
            'professional': 'Â∞àÊ•≠Á®ãÂ∫¶',
            'follower': 'Á≤âÁµ≤ÂìÅË≥™',
            'unique': 'È¢®Ê†ºÁç®Áâπ',
            'engagement': '‰∫íÂãïÊΩõÂäõ',
            'niche': 'Âà©Âü∫Â∞àÊ≥®',
            'audience': 'ÂèóÁúæÂÉπÂÄº',
            'cross_platform': 'Ë∑®Âπ≥Âè∞'
        };

        // Ë®àÁÆóÂ∏≥ËôüÂ∏ÇÂ†¥ÂÉπÂÄºÔºàÂèÉËÄÉÁúüÂØ¶Â∏ÇÂ†¥Ë°åÊÉÖÔºâ
        function calculateAccountValue(data) {
            const followers = data.followers || 0;
            const value = data.value_estimation || {};
            const multipliers = value.multipliers || {};
            
            // === Á¨¨‰∏ÄÊ≠•ÔºöË®àÁÆóÂü∫Á§éÊØèÁ≤âÂÉπÂÄºÔºàÊ†πÊìöÁ≤âÁµ≤Ë¶èÊ®°Ôºâ ===
            let basePerFollower;
            
            if (followers < 1000) {
                basePerFollower = 1.5;          // Á¥†‰∫∫Ôºö1.5ÂÖÉ/Á≤â
            } else if (followers < 5000) {
                basePerFollower = 2;            // Êñ∞ÊòüÔºö2ÂÖÉ/Á≤â
            } else if (followers < 10000) {
                basePerFollower = 3;            // ÊΩõÂäõËÇ°Ôºö3ÂÖÉ/Á≤â
            } else if (followers < 50000) {
                basePerFollower = 4;            // ÂæÆÁ∂≤Á¥ÖÔºö4ÂÖÉ/Á≤â
            } else if (followers < 100000) {
                basePerFollower = 5;            // ÊÑèË¶ãÈ†òË¢ñÔºö5ÂÖÉ/Á≤â
            } else if (followers < 300000) {
                basePerFollower = 4;            // Á∂≤Á¥ÖÁ¥öÔºö4ÂÖÉ/Á≤âÔºàÈÇäÈöõÈÅûÊ∏õÔºâ
            } else {
                basePerFollower = 3;            // Âêç‰∫∫Á¥öÔºö3ÂÖÉ/Á≤âÔºàÈÇäÈöõÈÅûÊ∏õÔºâ
            }
            
            // === Á¨¨‰∫åÊ≠•ÔºöË®àÁÆóÂìÅË≥™‰øÇÊï∏ÔºàÂü∫ÊñºAIÂàÜÊûêÁöÑÂêÑÈ†Ö‰øÇÊï∏Ôºâ ===
            
            // Áç≤ÂèñÂêÑÈ†Ö‰øÇÊï∏
            const visual = multipliers.visual || 1.0;
            const content = multipliers.content || 1.0;
            const professional = multipliers.professional || 1.0;
            const follower = multipliers.follower || 1.0;
            const unique = multipliers.unique || 1.0;
            const engagement = multipliers.engagement || 1.0;
            const niche = multipliers.niche || 1.0;
            const audience = multipliers.audience || 1.0;
            const crossPlatform = multipliers.cross_platform || 1.0;
            
            // Ë®àÁÆóÁ∂úÂêàÂìÅË≥™ÂàÜÊï∏ÔºàÂä†Ê¨äÂπ≥ÂùáÔºåËÄåÈùû‰πòÁ©çÔºâ
            const qualityScore = (
                visual * 0.15 +           // Ë¶ñË¶∫ÂìÅË≥™ 15%
                content * 0.15 +          // ÂÖßÂÆπÂÆö‰Ωç 15%
                engagement * 0.20 +       // ‰∫íÂãïÊΩõÂäõ 20%ÔºàÊúÄÈáçË¶ÅÔºâ
                niche * 0.15 +            // Âà©Âü∫Â∞àÊ≥® 15%
                audience * 0.15 +         // ÂèóÁúæÂÉπÂÄº 15%
                professional * 0.10 +     // Â∞àÊ•≠Á®ãÂ∫¶ 10%
                unique * 0.05 +           // È¢®Ê†ºÁç®Áâπ 5%
                follower * 0.03 +         // Á≤âÁµ≤ÂìÅË≥™ 3%
                crossPlatform * 0.02      // Ë∑®Âπ≥Âè∞ 2%
            );
            
            // ÂìÅË≥™‰øÇÊï∏ÁØÑÂúçÔºö0.6x ~ 2.0x
            const qualityMultiplier = Math.max(0.6, Math.min(qualityScore, 2.0));
            
            // === Á¨¨‰∏âÊ≠•ÔºöË®àÁÆóÊúÄÁµÇÂ∏≥ËôüÂÉπÂÄº ===
            const accountValue = Math.floor(followers * basePerFollower * qualityMultiplier);
            
            return accountValue;
        }

        // Ê∏≤ÊüìÁµêÊûú
        function renderResult(data) {
            // Ê∑ªÂä†Ë™øË©¶‰ø°ÊÅØ
            console.log('renderResult called with data:', data);
            console.log('Username:', data.username);
            console.log('Followers:', data.followers);
            console.log('Account value min:', data.value_estimation?.account_value_min);
            console.log('Account value max:', data.value_estimation?.account_value_max);
            
      // Âü∫Êú¨Ë≥áË®ä
            document.getElementById('username').textContent = data.username || 'username';
            document.getElementById('display-name').textContent = data.display_name || 'Âè∞ÂåóÁæéÈ£üÊé¢Á¥¢ËÄÖ';
      document.getElementById('followers').textContent = formatNumber(data.followers || 0);
      document.getElementById('following').textContent = formatNumber(data.following || 0);
      document.getElementById('posts').textContent = formatNumber(data.posts || 0);
      
            // Á≤âÁµ≤Á¥öÂà•ÂíåÁ§æÁæ§ÂÆö‰Ωç
      const value = data.value_estimation || {};
            const personality = data.primary_type || {};
            
            // Êõ¥Êñ∞Á≤âÁµ≤Á¥öÂà•ÂæΩÁ´†
            document.getElementById('follower-tier').textContent = value.follower_tier || 'Ë©ï‰º∞‰∏≠';

            // Êõ¥Êñ∞‰∫∫Ê†ºÈ°ûÂûãË≥áË®ä
            document.getElementById('personality-name').textContent = personality.name_zh || 'ÂàÜÊûê‰∏≠';
            document.getElementById('personality-en').textContent = personality.name_en || 'Analyzing';

            // Â∏≥ËôüÂ∏ÇÂ†¥ÂÉπÂÄºÔºàÂÑ™ÂÖà‰ΩøÁî® AI ‰º∞ÁÆóÁöÑÂÉπÊ†ºÔºåÂê¶Ââá‰ΩøÁî®ÂâçÁ´ØË®àÁÆóÔºâ
            let accountValue;
            console.log('Value estimation data:', value);
            console.log('Account value min:', value.account_value_min);
            console.log('Account value max:', value.account_value_max);
            
            // Áõ¥Êé•‰ΩøÁî®ÂâçÁ´ØË®àÁÆóÁöÑ‰º∞ÂÄºÁ≥ªÁµ±
            accountValue = calculateAccountValue(data);
            console.log('Using frontend calculated value:', accountValue);
            
            const totalValueEl = document.getElementById('total-value');
            console.log('Total value element found:', totalValueEl);
            console.log('Current total value text:', totalValueEl?.textContent);
            
            // Êï∏Â≠óÂãïÁï´ÊïàÊûú
            let currentValue = 0;
            const increment = accountValue / 50;
            const timer = setInterval(() => {
                currentValue += increment;
                if (currentValue >= accountValue) {
                    currentValue = accountValue;
                    clearInterval(timer);
                }
                totalValueEl.textContent = formatPrice(Math.floor(currentValue));
                console.log('Updated total value to:', totalValueEl.textContent);
            }, 20);

            // Á§æÁæ§ÂÆö‰ΩçË©≥Á¥∞Ë≥áË®ä
            document.getElementById('personality-name').textContent = personality.name_zh || 'ÂàÜÊûê‰∏≠';
            document.getElementById('personality-en').textContent = personality.name_en || 'Analyzing';

            // AI ÂàÜÊûêÊñáÂ≠óÔºàV5 Êñ∞Â¢ûÔºåÂ¶ÇÊûúÊúâÁöÑË©±ÊâçÈ°ØÁ§∫Ôºâ
            if (data.analysis_text && data.analysis_text.trim()) {
                const analysisSection = document.getElementById('analysis-section');
                const analysisText = document.getElementById('analysis-text');
                
                // Â∞áÊèõË°åËΩâÊèõÁÇ∫ÊÆµËêΩ
                const paragraphs = data.analysis_text.trim().split('\n\n').filter(p => p.trim());
                analysisText.innerHTML = paragraphs.map(p => `<p>${p}</p>`).join('');
                
                analysisSection.style.display = 'block';
            }

            // === Ë®àÁÆóÂêà‰ΩúÂ†±ÂÉπ ===
            let postPrice, storyPrice, reelsPrice;
            
            console.log('Pricing data:', {
                post_value: value.post_value,
                story_value: value.story_value,
                reels_value: value.reels_value
            });
            
            // Áõ¥Êé•‰ΩøÁî®ÂâçÁ´ØË®àÁÆóÁöÑÂ†±ÂÉπÁ≥ªÁµ±
            const followers = data.followers || 0;
            
            // Âü∫Á§éÂ†±ÂÉπË®àÁÆóÔºàÊØèÂçÉÁ≤âÂÉπÂÄºÔºâ
            let basePricePerK;
            if (followers < 1000) {
                basePricePerK = 300;
            } else if (followers < 5000) {
                basePricePerK = 500;
            } else if (followers < 10000) {
                basePricePerK = 600;
            } else if (followers < 50000) {
                basePricePerK = 700;
            } else if (followers < 100000) {
                basePricePerK = 800;
            } else if (followers < 300000) {
                basePricePerK = 700;
            } else {
                basePricePerK = 600;
            }

            
            // Ë®àÁÆóÂìÅË≥™‰øÇÊï∏
            const visual = multipliers.visual || 1.0;
            const content = multipliers.content || 1.0;
            const professional = multipliers.professional || 1.0;
            const follower = multipliers.follower || 1.0;
            const unique = multipliers.unique || 1.0;
            const engagement = multipliers.engagement || 1.0;
            const niche = multipliers.niche || 1.0;
            const audience = multipliers.audience || 1.0;
            const crossPlatform = multipliers.cross_platform || 1.0;
            
            const qualityScore = (
                visual * 0.15 +
                content * 0.15 +
                engagement * 0.20 +
                niche * 0.15 +
                audience * 0.15 +
                professional * 0.10 +
                unique * 0.05 +
                follower * 0.03 +
                crossPlatform * 0.02
            );
            
            const qualityMultiplier = Math.max(0.6, Math.min(qualityScore, 2.0));
            
            const basePostPrice = (followers / 1000) * basePricePerK * qualityMultiplier;
            postPrice = Math.floor(basePostPrice);
            storyPrice = Math.floor(postPrice * 0.4);
            reelsPrice = Math.floor(postPrice * 1.5);
            
            // È°ØÁ§∫Â†±ÂÉπ
            const postValueEl = document.getElementById('post-value');
            const storyValueEl = document.getElementById('story-value');
            const reelsValueEl = document.getElementById('reels-value');
            
            console.log('Pricing elements found:', {
                post: postValueEl,
                story: storyValueEl,
                reels: reelsValueEl
            });
            
            postValueEl.textContent = formatPrice(postPrice);
            storyValueEl.textContent = formatPrice(storyPrice);
            reelsValueEl.textContent = formatPrice(reelsPrice);
            
            console.log('Updated pricing values:', {
                post: postValueEl.textContent,
                story: storyValueEl.textContent,
                reels: reelsValueEl.textContent
            });

            // ‰øÇÊï∏
            const multipliersGrid = document.getElementById('multipliers-grid');
            multipliersGrid.innerHTML = '';

            Object.keys(multiplierLabels).forEach(key => {
                if (multipliers[key]) {
                    const item = document.createElement('div');
                    item.className = 'multiplier-item';
                    item.innerHTML = `
                        <span class="multiplier-label">${multiplierLabels[key]}</span>
                    `;
                    multipliersGrid.appendChild(item);
                }
            });

            // ÊèêÂçáÂª∫Ë≠∞
      const tips = data.improvement_tips || [];
            const tipsContainer = document.getElementById('tips-container');
            tipsContainer.innerHTML = '';
      
        tips.forEach(tip => {
                const tipItem = document.createElement('div');
                tipItem.className = 'tip-item';
                tipItem.textContent = tip;
                tipsContainer.appendChild(tipItem);
            });

            // È°ØÁ§∫ÁµêÊûúÔºåÈö±Ëóè loading
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('result').classList.remove('hidden');
        }

        // È°ØÁ§∫‰øÇÊï∏Ë©≥Á¥∞Ë≥áË®ä
        function showMultiplierDetails() {
            const details = `
ÂÉπÂÄºÂèÉËÄÉÁ∂≠Â∫¶Ë™™ÊòéÔºö

‚Ä¢ Ë¶ñË¶∫ÂìÅË≥™ÔºöÁÖßÁâáÊßãÂúñ„ÄÅËâ≤ÂΩ©Êê≠ÈÖç„ÄÅÊï¥È´îÁæéÊÑü
‚Ä¢ ÂÖßÂÆπÂÆö‰ΩçÔºöÂÖßÂÆπ‰∏ªÈ°åÊòéÁ¢∫Â∫¶„ÄÅÂûÇÁõ¥È†òÂüüÂ∞àÁ≤æÂ∫¶
‚Ä¢ Â∞àÊ•≠Á®ãÂ∫¶ÔºöÂÖßÂÆπÂ∞àÊ•≠ÊÄß„ÄÅÂèØ‰ø°Â∫¶„ÄÅÊ¨äÂ®ÅÊÑü
‚Ä¢ Á≤âÁµ≤ÂìÅË≥™ÔºöÁ≤âÁµ≤Ê¥ªË∫çÂ∫¶„ÄÅ‰∫íÂãïÁéá„ÄÅÂø†Ë™†Â∫¶
‚Ä¢ È¢®Ê†ºÁç®ÁâπÔºöÂÄã‰∫∫È¢®Ê†ºËæ®Ë≠òÂ∫¶„ÄÅÂâµÊÑèË°®Áèæ
‚Ä¢ ‰∫íÂãïÊΩõÂäõÔºöÁ≤âÁµ≤ÂèÉËàáÂ∫¶„ÄÅË©ïË´ñË≥™Èáè„ÄÅÂàÜ‰∫´ÊÑèÈ°ò
‚Ä¢ Âà©Âü∫Â∞àÊ≥®ÔºöÁâπÂÆöÈ†òÂüüÊ∑±ËÄïÁ®ãÂ∫¶„ÄÅÂ∞àÊ•≠Áü•Ë≠ò
‚Ä¢ ÂèóÁúæÂÉπÂÄºÔºöÁ≤âÁµ≤Áæ§È´îÂïÜÊ•≠ÂÉπÂÄº„ÄÅÊ∂àË≤ªËÉΩÂäõ
‚Ä¢ Ë∑®Âπ≥Âè∞ÔºöÂ§öÂπ≥Âè∞ÂΩ±ÈüøÂäõ„ÄÅÂìÅÁâå‰∏ÄËá¥ÊÄß

ÈÄô‰∫õÁ∂≠Â∫¶Á∂úÂêàË©ï‰º∞ÊÇ®ÁöÑÂ∏≥ËôüÂú®ÂïÜÊ•≠Âêà‰Ωú‰∏≠ÁöÑÊΩõÂú®ÂÉπÂÄº„ÄÇ
            `;
            alert(details);
        }

        // ÂàÜ‰∫´ÂäüËÉΩ
        function shareResult() {
            // Â¶ÇÊûúÊîØÊè¥ Web Share API
            if (navigator.share) {
                const username = document.getElementById('username').textContent;
                const totalValue = document.getElementById('total-value').textContent;
                
                navigator.share({
                    title: `ÊàëÁöÑ IG Â∏≥ËôüÂÉπÂÄºÂ†±Âëä`,
                    text: `ÊàëÁöÑ @${username} Â∏≥ËôüÂÉπÂÄºÔºö${totalValue}ÔºÅÂø´‰æÜÊ∏¨Ê∏¨‰Ω†ÁöÑÂ∏≥ËôüÂÄºÂ§öÂ∞ë üí∞`,
                    url: window.location.href
                }).catch(err => console.log('ÂàÜ‰∫´ÂèñÊ∂àÊàñÂ§±Êïó:', err));
            } else {
                // ÈôçÁ¥öÊñπÊ°àÔºöË§áË£ΩÈÄ£Áµê
                alert('Ë´ãÊà™ÂúñÂàÜ‰∫´‰Ω†ÁöÑÁµêÊûúÔºÅ\n\nÊèêÁ§∫ÔºöÂèØ‰ª•Èï∑ÊåâËû¢ÂπïÊà™Âúñ üì∏');
            }
        }

        // Ê®°Êì¨Êï∏ÊìöÔºàÊ∏¨Ë©¶Áî®Ôºâ

        // Âæû URL ÂèÉÊï∏„ÄÅsessionStorage Êàñ localStorage Áç≤ÂèñÊï∏Êìö
        function getAnalysisData() {
            // 1. ÂòóË©¶Âæû URL ÂèÉÊï∏Áç≤Âèñ
            const urlParams = new URLSearchParams(window.location.search);
            const dataParam = urlParams.get('data');
            
            if (dataParam) {
                try {
                    return JSON.parse(decodeURIComponent(dataParam));
                } catch (e) {
                    console.error('Failed to parse URL data:', e);
                }
            }
            
            // 2. ÂòóË©¶Âæû sessionStorage Áç≤ÂèñÔºàupload.html Â≠òÂÑ≤ÁöÑÂú∞ÊñπÔºâ
            const sessionData = sessionStorage.getItem('sa_result');
            if (sessionData) {
                try {
                    return JSON.parse(sessionData);
                } catch (e) {
                    console.error('Failed to parse session data:', e);
                }
            }
            
            // 3. ÂòóË©¶Âæû localStorage Áç≤Âèñ
            const storedData = localStorage.getItem('ig_analysis_result');
            if (storedData) {
                try {
                    return JSON.parse(storedData);
                } catch (e) {
                    console.error('Failed to parse stored data:', e);
                }
            }
            
            // 4. Â¶ÇÊûúÈÉΩÊ≤íÊúâÔºåËøîÂõû nullÔºàÈ°ØÁ§∫ÈåØË™§ÊàñÈáçÂÆöÂêëÔºâ
            return null;
        }

        // ËºâÂÖ•Ê≠•È©üÂãïÁï´
        function animateLoadingSteps() {
            const steps = document.querySelectorAll('.loading-step');
            let currentStep = 0;
            
            const stepInterval = setInterval(() => {
                // ÁßªÈô§ÊâÄÊúâ active È°ûÂà•
                steps.forEach(step => step.classList.remove('active'));
                
                // Ê∑ªÂä† active È°ûÂà•Âà∞Áï∂ÂâçÊ≠•È©ü
                if (currentStep < steps.length) {
                    steps[currentStep].classList.add('active');
                    currentStep++;
                } else {
                    clearInterval(stepInterval);
                }
            }, 500);
        }

        // È†ÅÈù¢ËºâÂÖ•ÊôÇ
        window.addEventListener('DOMContentLoaded', () => {
            // ÈñãÂßãËºâÂÖ•Ê≠•È©üÂãïÁï´
            animateLoadingSteps();
            
            const analysisData = getAnalysisData();
            
            // Ê∑ªÂä†Ë™øË©¶‰ø°ÊÅØ
            console.log('Analysis data:', analysisData);
            console.log('Session storage:', sessionStorage.getItem('sa_result'));
            console.log('URL params:', window.location.search);
            
            if (analysisData && analysisData.ok) {
                console.log('Using real analysis data');
                // ‰ΩøÁî®ÁúüÂØ¶ÁöÑÂàÜÊûêÊï∏Êìö
                setTimeout(() => {
                    renderResult(analysisData);
                }, 2000);
            } else {
                console.log('No analysis data found - redirecting to upload page');
                // Ê≤íÊúâÊï∏ÊìöÔºåÈáçÂÆöÂêëÂà∞‰∏äÂÇ≥È†ÅÈù¢
                alert('Ê≤íÊúâÊâæÂà∞ÂàÜÊûêÊï∏ÊìöÔºåË´ãÈáçÊñ∞‰∏äÂÇ≥Êà™ÂúñÈÄ≤Ë°åÂàÜÊûê„ÄÇ');
                window.location.href = '/static/upload.html';
            }
        });
  </script>
</body>
</html>