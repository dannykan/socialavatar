<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘çš„ IG å¸³è™Ÿåƒ¹å€¼å ±å‘Š</title>
  <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

    body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
            padding: 20px;
      display: flex;
            justify-content: center;
      align-items: center;
    }
    
    .container {
            max-width: 500px;
            width: 100%;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 30px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
        }

        /* Instagram é¢¨æ ¼æ¼¸è®Šé ­éƒ¨ */
        .header {
            background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
            padding: 40px 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
        .header::before {
      content: '';
      position: absolute;
      top: -50%;
            left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .username {
            color: white;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
      position: relative;
      z-index: 1;
    }
    
        .username::before {
            content: '@';
            opacity: 0.8;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            color: white;
            font-size: 13px;
            margin-top: 15px;
            position: relative;
            z-index: 1;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-weight: 700;
            font-size: 16px;
            display: block;
        }

        .stat-label {
      opacity: 0.9;
            font-size: 11px;
        }

        /* ä¸»è¦åƒ¹å€¼å±•ç¤ºå€ */
        .value-section {
            padding: 40px 30px 30px;
            text-align: center;
            background: linear-gradient(180deg, #fff 0%, #fafafa 100%);
        }

        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .value-title {
            font-size: 16px;
            color: #666;
            margin-bottom: 15px;
      font-weight: 500;
    }
    
        .total-value {
            font-size: 64px;
      font-weight: 800;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1.2;
            margin-bottom: 10px;
            animation: valueAppear 0.8s ease-out;
        }

        @keyframes valueAppear {
            0% {
                opacity: 0;
                transform: scale(0.5);
            }
            60% {
                transform: scale(1.1);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        .value-subtitle {
            font-size: 14px;
            color: #999;
            margin-bottom: 25px;
        }

        /* æ•´åˆçš„å¸³è™Ÿè³‡è¨Šå¡ç‰‡ */
        .account-info-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            padding: 25px;
            margin-top: 20px;
            color: white;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .account-badges {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tier-badge {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 12px;
            padding: 6px 15px;
        }

        .personality-badge {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-size: 12px;
            padding: 6px 15px;
        }

        .personality-details {
            display: flex;
      align-items: center;
            gap: 15px;
        }

        .personality-emoji {
            font-size: 40px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        .personality-info {
            flex: 1;
        }

        .personality-name {
            font-size: 18px;
      font-weight: 700;
            margin-bottom: 3px;
        }

        .personality-en {
            font-size: 12px;
            opacity: 0.9;
            font-style: italic;
            margin-bottom: 8px;
        }

        .personality-confidence {
            font-size: 11px;
            opacity: 0.8;
        }


        /* AI åˆ†ææ–‡å­—å€å¡Šï¼ˆæ–°å¢ï¼‰*/
        .analysis-section {
            padding: 25px 30px;
            background: white;
        }

        .analysis-title {
      font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .analysis-text {
            font-size: 14px;
            line-height: 1.8;
      color: #555;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid #667eea;
        }

        .analysis-text p {
            margin-bottom: 15px;
        }

        .analysis-text p:last-child {
            margin-bottom: 0;
        }

        /* åˆä½œå ±åƒ¹å€å¡Š */
        .pricing-section {
            padding: 25px 30px;
            background: linear-gradient(180deg, #fafafa 0%, #f5f5f5 100%);
      border-radius: 20px;
            margin: 0 30px 25px;
        }

        .pricing-title {
            font-size: 18px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .pricing-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .price-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            padding: 20px 15px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .price-card:hover {
            border-color: #667eea;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.15);
        }

        .price-type {
            font-size: 12px;
            color: #666;
            text-transform: uppercase;
            font-weight: 600;
            margin-bottom: 10px;
            letter-spacing: 0.5px;
        }

        .price-value {
      font-size: 20px;
      font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* ä¿‚æ•¸å±•ç¤º */
        .multipliers-section {
            padding: 25px 30px;
            background: #fafafa;
        }

        .multipliers-title {
            font-size: 16px;
            font-weight: 700;
      color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .multiplier-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .multiplier-item {
            background: white;
            border-radius: 12px;
            padding: 12px;
      display: flex;
            justify-content: space-between;
      align-items: center;
            border: 1px solid #f0f0f0;
        }

        .multiplier-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .multiplier-value {
            font-size: 16px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* æå‡å»ºè­° */
        .tips-section {
            padding: 25px 30px;
            background: white;
        }

        .tips-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            margin-bottom: 15px;
            text-align: center;
        }

        .tip-item {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 10px;
      font-size: 13px;
      color: #555;
            line-height: 1.5;
        }

        .tip-item::before {
            content: 'ğŸ’¡ ';
            margin-right: 5px;
        }

        /* åˆ†äº«æŒ‰éˆ• */
        .share-section {
            padding: 25px 30px 35px;
            text-align: center;
            background: white;
        }

        .share-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
            padding: 15px 40px;
            border-radius: 25px;
      font-size: 16px;
            font-weight: 700;
      cursor: pointer;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .share-button:hover {
      transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.5);
        }

        .share-button:active {
            transform: translateY(0);
        }

        /* åº•éƒ¨ç½²å */
        .footer {
            padding: 20px;
            text-align: center;
            background: #f5f5f5;
            font-size: 11px;
            color: #999;
        }

        /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
        @media (max-width: 480px) {
            .container {
                border-radius: 0;
                box-shadow: none;
            }

            .total-value {
                font-size: 52px;
            }

            .account-badges {
                flex-direction: column;
                gap: 8px;
            }

            .personality-details {
                flex-direction: column;
                text-align: center;
                gap: 10px;
            }

            .pricing-cards {
        grid-template-columns: 1fr;
      }
      
            .multiplier-grid {
        grid-template-columns: 1fr;
      }
      
            .pricing-section {
                margin: 0 20px 25px;
                padding: 20px;
            }
        }

        /* Loading å‹•ç•« */
        .loading {
            text-align: center;
            padding: 60px 30px;
            color: white;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
    }
  </style>
</head>
<body>
    <div class="container">
        <!-- Loading ç‹€æ…‹ -->
        <div id="loading" class="loading">
            <div class="loading-spinner"></div>
            <p>æ­£åœ¨åˆ†æä½ çš„ IG å¸³è™Ÿ...</p>
    </div>
    
        <!-- çµæœå±•ç¤ºï¼ˆé è¨­éš±è—ï¼‰ -->
        <div id="result" class="hidden">
            <!-- Instagram é¢¨æ ¼é ­éƒ¨ -->
            <div class="header">
                <div class="username" id="username">username</div>
                <div class="stats">
                    <div class="stat-item">
                        <span class="stat-number" id="followers">0</span>
                        <span class="stat-label">ç²‰çµ²</span>
        </div>
                    <div class="stat-item">
                        <span class="stat-number" id="following">0</span>
                        <span class="stat-label">è¿½è¹¤</span>
        </div>
                    <div class="stat-item">
                        <span class="stat-number" id="posts">0</span>
                        <span class="stat-label">è²¼æ–‡</span>
          </div>
      </div>
    </div>
    
            <!-- ä¸»è¦åƒ¹å€¼å±•ç¤º -->
            <div class="value-section">
                <div class="value-title">ä½ çš„å¸³è™Ÿç¸½åƒ¹å€¼</div>
                <div class="total-value" id="total-value">NT$ 0</div>
                <div class="value-subtitle">åŸºæ–¼ AI å¤šç¶­åº¦åˆ†æ</div>
                
                <!-- æ•´åˆçš„å¸³è™Ÿè³‡è¨Šå¡ç‰‡ -->
                <div class="account-info-card">
                    <div class="account-badges">
                        <div class="badge tier-badge" id="follower-tier">è©•ä¼°ä¸­</div>
                        <div class="badge personality-badge" id="personality-type">åˆ†æä¸­...</div>
          </div>
                    <div class="personality-details">
                        <span class="personality-emoji" id="personality-emoji">âœ¨</span>
                        <div class="personality-info">
                            <div class="personality-name" id="personality-name">åˆ†æä¸­...</div>
                            <div class="personality-en" id="personality-en">Analyzing...</div>
                            <div class="personality-confidence">
                                ä¿¡å¿ƒåº¦ï¼š<span id="personality-confidence">0</span>%
        </div>
          </div>
          </div>
          </div>
        </div>
        
            <!-- AI å°ˆæ¥­åˆ†æï¼ˆæ–°å¢ï¼Œåƒ…ç•¶æœ‰ analysis_text æ™‚é¡¯ç¤ºï¼‰-->
            <div class="analysis-section" id="analysis-section" style="display:none;">
                <div class="analysis-title">ğŸ’¼ å°ˆæ¥­ä¼°å€¼åˆ†æ</div>
                <div class="analysis-text" id="analysis-text"></div>
        </div>
        
            <!-- åˆä½œå ±åƒ¹ï¼ˆæ•´åˆåˆ°åƒ¹å€¼å±•ç¤ºå€ï¼‰ -->
            <div class="pricing-section">
                <div class="pricing-title">ğŸ’° åˆä½œå ±åƒ¹åƒè€ƒ</div>
                <div class="pricing-cards">
                    <div class="price-card">
                        <div class="price-type">è²¼æ–‡</div>
                        <div class="price-value" id="post-value">NT$ 0</div>
          </div>
                    <div class="price-card">
                        <div class="price-type">é™å‹•</div>
                        <div class="price-value" id="story-value">NT$ 0</div>
          </div>
                    <div class="price-card">
                        <div class="price-type">çŸ­å½±éŸ³</div>
                        <div class="price-value" id="reels-value">NT$ 0</div>
        </div>
      </div>
    </div>
    
            <!-- ä¿‚æ•¸å±•ç¤º -->
            <div class="multipliers-section">
                <div class="multipliers-title">ğŸ“Š åƒ¹å€¼ä¿‚æ•¸</div>
                <div class="multiplier-grid" id="multipliers-grid">
                    <!-- å°‡ç”± JS å‹•æ…‹ç”Ÿæˆ -->
      </div>
    </div>

            <!-- æå‡å»ºè­° -->
            <div class="tips-section">
                <div class="tips-title">ğŸ’¡ åƒ¹å€¼æå‡å»ºè­°</div>
                <div id="tips-container">
                    <!-- å°‡ç”± JS å‹•æ…‹ç”Ÿæˆ -->
      </div>
    </div>

            <!-- åˆ†äº«æŒ‰éˆ• -->
            <div class="share-section">
                <button class="share-button" onclick="shareResult()">
                    <span>ğŸ“¸</span>
                    <span>åˆ†äº«æˆ‘çš„å¸³è™Ÿåƒ¹å€¼</span>
                </button>
    </div>

            <!-- åº•éƒ¨ -->
            <div class="footer">
                Powered by IG Value Estimation System V5
    </div>
      </div>
    </div>

    <script>
        // æ ¼å¼åŒ–æ•¸å­—ï¼ˆåŠ åƒåˆ†ä½ï¼‰
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // æ ¼å¼åŒ–é‡‘é¡
        function formatPrice(price) {
            if (price >= 10000) {
                return `NT$ ${(price / 10000).toFixed(1)}è¬`;
            }
            return `NT$ ${formatNumber(price)}`;
        }

        // ä¿‚æ•¸æ¨™ç±¤æ˜ å°„
        const multiplierLabels = {
            'visual': 'è¦–è¦ºå“è³ª',
            'content': 'å…§å®¹é¡å‹',
            'professional': 'å°ˆæ¥­ç¨‹åº¦',
            'follower': 'ç²‰çµ²å“è³ª',
            'unique': 'é¢¨æ ¼ç¨ç‰¹',
            'engagement': 'äº’å‹•æ½›åŠ›',
            'niche': 'åˆ©åŸºå°ˆæ³¨',
            'audience': 'å—çœ¾åƒ¹å€¼',
            'cross_platform': 'è·¨å¹³å°'
        };

        // è¨ˆç®—å¸³è™Ÿå¸‚å ´åƒ¹å€¼ï¼ˆåƒè€ƒçœŸå¯¦å¸‚å ´è¡Œæƒ…ï¼‰
        function calculateAccountValue(data) {
            const followers = data.followers || 0;
            const value = data.value_estimation || {};
            const multipliers = value.multipliers || {};
            
            // === ç¬¬ä¸€æ­¥ï¼šè¨ˆç®—åŸºç¤æ¯ç²‰åƒ¹å€¼ï¼ˆæ ¹æ“šç²‰çµ²è¦æ¨¡ï¼‰ ===
            let basePerFollower;
            
            if (followers < 1000) {
                basePerFollower = 1.5;          // ç´ äººï¼š1.5å…ƒ/ç²‰
            } else if (followers < 5000) {
                basePerFollower = 2;            // æ–°æ˜Ÿï¼š2å…ƒ/ç²‰
            } else if (followers < 10000) {
                basePerFollower = 3;            // æ½›åŠ›è‚¡ï¼š3å…ƒ/ç²‰
            } else if (followers < 50000) {
                basePerFollower = 4;            // å¾®ç¶²ç´…ï¼š4å…ƒ/ç²‰
            } else if (followers < 100000) {
                basePerFollower = 5;            // æ„è¦‹é ˜è¢–ï¼š5å…ƒ/ç²‰
            } else if (followers < 300000) {
                basePerFollower = 4;            // ç¶²ç´…ç´šï¼š4å…ƒ/ç²‰ï¼ˆé‚Šéš›éæ¸›ï¼‰
            } else {
                basePerFollower = 3;            // åäººç´šï¼š3å…ƒ/ç²‰ï¼ˆé‚Šéš›éæ¸›ï¼‰
            }
            
            // === ç¬¬äºŒæ­¥ï¼šè¨ˆç®—å“è³ªä¿‚æ•¸ï¼ˆåŸºæ–¼AIåˆ†æçš„å„é …ä¿‚æ•¸ï¼‰ ===
            
            // ç²å–å„é …ä¿‚æ•¸
            const visual = multipliers.visual || 1.0;
            const content = multipliers.content || 1.0;
            const professional = multipliers.professional || 1.0;
            const follower = multipliers.follower || 1.0;
            const unique = multipliers.unique || 1.0;
            const engagement = multipliers.engagement || 1.0;
            const niche = multipliers.niche || 1.0;
            const audience = multipliers.audience || 1.0;
            const crossPlatform = multipliers.cross_platform || 1.0;
            
            // è¨ˆç®—ç¶œåˆå“è³ªåˆ†æ•¸ï¼ˆåŠ æ¬Šå¹³å‡ï¼Œè€Œéä¹˜ç©ï¼‰
            const qualityScore = (
                visual * 0.15 +           // è¦–è¦ºå“è³ª 15%
                content * 0.15 +          // å…§å®¹é¡å‹ 15%
                engagement * 0.20 +       // äº’å‹•æ½›åŠ› 20%ï¼ˆæœ€é‡è¦ï¼‰
                niche * 0.15 +            // åˆ©åŸºå°ˆæ³¨ 15%
                audience * 0.15 +         // å—çœ¾åƒ¹å€¼ 15%
                professional * 0.10 +     // å°ˆæ¥­ç¨‹åº¦ 10%
                unique * 0.05 +           // é¢¨æ ¼ç¨ç‰¹ 5%
                follower * 0.03 +         // ç²‰çµ²å“è³ª 3%
                crossPlatform * 0.02      // è·¨å¹³å° 2%
            );
            
            // å“è³ªä¿‚æ•¸ç¯„åœï¼š0.6x ~ 2.0x
            const qualityMultiplier = Math.max(0.6, Math.min(qualityScore, 2.0));
            
            // === ç¬¬ä¸‰æ­¥ï¼šè¨ˆç®—æœ€çµ‚å¸³è™Ÿåƒ¹å€¼ ===
            const accountValue = Math.floor(followers * basePerFollower * qualityMultiplier);
            
            return accountValue;
        }

        // æ¸²æŸ“çµæœ
        function renderResult(data) {
      // åŸºæœ¬è³‡è¨Š
            document.getElementById('username').textContent = data.username || 'username';
      document.getElementById('followers').textContent = formatNumber(data.followers || 0);
      document.getElementById('following').textContent = formatNumber(data.following || 0);
      document.getElementById('posts').textContent = formatNumber(data.posts || 0);
      
            // ç²‰çµ²ç´šåˆ¥å’Œäººæ ¼é¡å‹
      const value = data.value_estimation || {};
            const personality = data.primary_type || {};
            
            // æ›´æ–°ç²‰çµ²ç´šåˆ¥å¾½ç« 
            document.getElementById('follower-tier').textContent = value.follower_tier || 'è©•ä¼°ä¸­';
            
            // æ›´æ–°äººæ ¼é¡å‹å¾½ç« 
            document.getElementById('personality-type').textContent = personality.name_zh || 'åˆ†æä¸­...';

            // å¸³è™Ÿå¸‚å ´åƒ¹å€¼ï¼ˆå„ªå…ˆä½¿ç”¨ AI ä¼°ç®—çš„åƒ¹æ ¼ï¼Œå¦å‰‡ä½¿ç”¨å‰ç«¯è¨ˆç®—ï¼‰
            let accountValue;
            if (value.account_value_min && value.account_value_max) {
                // V5ï¼šä½¿ç”¨ AI çµ¦çš„åƒ¹æ ¼å€é–“ï¼ˆå–ä¸­é–“å€¼ï¼‰
                accountValue = Math.floor((value.account_value_min + value.account_value_max) / 2);
            } else {
                // V4ï¼šå‰ç«¯è¨ˆç®—
                accountValue = calculateAccountValue(data);
            }
            
            const totalValueEl = document.getElementById('total-value');
            
            // æ•¸å­—å‹•ç•«æ•ˆæœ
            let currentValue = 0;
            const increment = accountValue / 50;
            const timer = setInterval(() => {
                currentValue += increment;
                if (currentValue >= accountValue) {
                    currentValue = accountValue;
                    clearInterval(timer);
                }
                totalValueEl.textContent = formatPrice(Math.floor(currentValue));
            }, 20);

            // äººæ ¼é¡å‹è©³ç´°è³‡è¨Š
            document.getElementById('personality-emoji').textContent = personality.emoji || 'âœ¨';
            document.getElementById('personality-name').textContent = personality.name_zh || 'åˆ†æä¸­';
            document.getElementById('personality-en').textContent = personality.name_en || 'Analyzing';
            document.getElementById('personality-confidence').textContent = Math.round((personality.confidence || 0) * 100);

            // AI åˆ†ææ–‡å­—ï¼ˆV5 æ–°å¢ï¼Œå¦‚æœæœ‰çš„è©±æ‰é¡¯ç¤ºï¼‰
            if (data.analysis_text && data.analysis_text.trim()) {
                const analysisSection = document.getElementById('analysis-section');
                const analysisText = document.getElementById('analysis-text');
                
                // å°‡æ›è¡Œè½‰æ›ç‚ºæ®µè½
                const paragraphs = data.analysis_text.trim().split('\n\n').filter(p => p.trim());
                analysisText.innerHTML = paragraphs.map(p => `<p>${p}</p>`).join('');
                
                analysisSection.style.display = 'block';
            }

            // === è¨ˆç®—åˆä½œå ±åƒ¹ ===
            let postPrice, storyPrice, reelsPrice;
            
            // å„ªå…ˆä½¿ç”¨ AI ä¼°ç®—çš„åƒ¹æ ¼ï¼ˆV5ï¼‰
            if (value.post_value && value.story_value && value.reels_value) {
                postPrice = value.post_value;
                storyPrice = value.story_value;
                reelsPrice = value.reels_value;
            } else {
                // é™ç´šä½¿ç”¨å‰ç«¯è¨ˆç®—ï¼ˆV4ï¼‰
                const followers = data.followers || 0;
                const multipliers = value.multipliers || {};
                
                // åŸºç¤å ±åƒ¹è¨ˆç®—ï¼ˆæ¯åƒç²‰åƒ¹å€¼ï¼‰
                let basePricePerK;
                if (followers < 1000) {
                    basePricePerK = 300;
                } else if (followers < 5000) {
                    basePricePerK = 500;
                } else if (followers < 10000) {
                    basePricePerK = 600;
                } else if (followers < 50000) {
                    basePricePerK = 700;
                } else if (followers < 100000) {
                    basePricePerK = 800;
                } else if (followers < 300000) {
                    basePricePerK = 700;
                } else {
                    basePricePerK = 600;
                }
                
                // è¨ˆç®—å“è³ªä¿‚æ•¸
                const visual = multipliers.visual || 1.0;
                const content = multipliers.content || 1.0;
                const professional = multipliers.professional || 1.0;
                const follower = multipliers.follower || 1.0;
                const unique = multipliers.unique || 1.0;
                const engagement = multipliers.engagement || 1.0;
                const niche = multipliers.niche || 1.0;
                const audience = multipliers.audience || 1.0;
                const crossPlatform = multipliers.cross_platform || 1.0;
                
                const qualityScore = (
                    visual * 0.15 +
                    content * 0.15 +
                    engagement * 0.20 +
                    niche * 0.15 +
                    audience * 0.15 +
                    professional * 0.10 +
                    unique * 0.05 +
                    follower * 0.03 +
                    crossPlatform * 0.02
                );
                
                const qualityMultiplier = Math.max(0.6, Math.min(qualityScore, 2.0));
                
                const basePostPrice = (followers / 1000) * basePricePerK * qualityMultiplier;
                postPrice = Math.floor(basePostPrice);
                storyPrice = Math.floor(postPrice * 0.4);
                reelsPrice = Math.floor(postPrice * 1.5);
            }
            
            // é¡¯ç¤ºå ±åƒ¹
            document.getElementById('post-value').textContent = formatPrice(postPrice);
            document.getElementById('story-value').textContent = formatPrice(storyPrice);
            document.getElementById('reels-value').textContent = formatPrice(reelsPrice);

            // ä¿‚æ•¸
            const multipliers = value.multipliers || {};
            const multipliersGrid = document.getElementById('multipliers-grid');
            multipliersGrid.innerHTML = '';

            Object.keys(multiplierLabels).forEach(key => {
                if (multipliers[key]) {
                    const item = document.createElement('div');
                    item.className = 'multiplier-item';
                    item.innerHTML = `
                        <span class="multiplier-label">${multiplierLabels[key]}</span>
                        <span class="multiplier-value">${multipliers[key]}Ã—</span>
                    `;
                    multipliersGrid.appendChild(item);
                }
            });

            // æå‡å»ºè­°
      const tips = data.improvement_tips || [];
            const tipsContainer = document.getElementById('tips-container');
            tipsContainer.innerHTML = '';
      
        tips.forEach(tip => {
                const tipItem = document.createElement('div');
                tipItem.className = 'tip-item';
                tipItem.textContent = tip;
                tipsContainer.appendChild(tipItem);
            });

            // é¡¯ç¤ºçµæœï¼Œéš±è— loading
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('result').classList.remove('hidden');
        }

        // åˆ†äº«åŠŸèƒ½
        function shareResult() {
            // å¦‚æœæ”¯æ´ Web Share API
            if (navigator.share) {
                const username = document.getElementById('username').textContent;
                const totalValue = document.getElementById('total-value').textContent;
                
                navigator.share({
                    title: `æˆ‘çš„ IG å¸³è™Ÿåƒ¹å€¼å ±å‘Š`,
                    text: `æˆ‘çš„ @${username} å¸³è™Ÿåƒ¹å€¼ï¼š${totalValue}ï¼å¿«ä¾†æ¸¬æ¸¬ä½ çš„å¸³è™Ÿå€¼å¤šå°‘ ğŸ’°`,
                    url: window.location.href
                }).catch(err => console.log('åˆ†äº«å–æ¶ˆæˆ–å¤±æ•—:', err));
            } else {
                // é™ç´šæ–¹æ¡ˆï¼šè¤‡è£½é€£çµ
                alert('è«‹æˆªåœ–åˆ†äº«ä½ çš„çµæœï¼\n\næç¤ºï¼šå¯ä»¥é•·æŒ‰è¢å¹•æˆªåœ– ğŸ“¸');
            }
        }

        // æ¨¡æ“¬æ•¸æ“šï¼ˆæ¸¬è©¦ç”¨ï¼‰
        const mockData = {
            "ok": true,
            "username": "foodie_taipei",
            "display_name": "å°åŒ—ç¾é£Ÿæ¢ç´¢è€…",
            "followers": 12500,
            "following": 850,
            "posts": 342,
            "primary_type": {
                "id": "type_5",
                "name_zh": "ç”Ÿæ´»è¨˜éŒ„è€…",
                "name_en": "Everyday Chronicler",
                "emoji": "ğŸœ",
                "confidence": 0.85
            },
            "value_estimation": {
                "base_price": 12000,
                "follower_tier": "æ„è¦‹é ˜è¢–",
                "follower_quality": "æœ‰å¸å¼•åŠ›",
                "account_value_min": 60000,      // AI ä¼°ç®—ï¼š6-10è¬
                "account_value_max": 100000,
                "account_value_reasoning": "ç²‰çµ²äº’å‹•è‰¯å¥½ï¼Œå…§å®¹å‚ç›´åº¦é«˜ï¼Œé©åˆç¾é£Ÿå“ç‰Œåˆä½œ",
                "multipliers": {
                    "visual": 1.5,
                    "content": 1.8,
                    "professional": 1.2,
                    "follower": 1.2,
                    "unique": 1.3,
                    "engagement": 1.25,
                    "niche": 1.4,
                    "audience": 1.6,
                    "cross_platform": 1.15
                },
                "post_value": 9000,        // æ›´æ–°ï¼š9åƒï¼ˆåˆç†ç¯„åœï¼‰
                "story_value": 3600,       // æ›´æ–°ï¼šPost çš„ 40%
                "reels_value": 13500       // æ›´æ–°ï¼šPost çš„ 150%
            },
            "improvement_tips": [
                "å¢åŠ èˆ‡ç²‰çµ²äº’å‹•çš„ Story å…§å®¹",
                "å»ºç«‹å›ºå®šç™¼æ–‡æ™‚æ®µæå‡ç²‰çµ²é»æ€§",
                "å˜—è©¦åŠ å…¥ç°¡çŸ­çš„ç¾é£Ÿå°çŸ¥è­˜",
                "è€ƒæ…®é–‹è¨­ YouTube é »é“æ“´å¤§å½±éŸ¿åŠ›"
            ]
        };

        // å¾ URL åƒæ•¸ã€sessionStorage æˆ– localStorage ç²å–æ•¸æ“š
        function getAnalysisData() {
            // 1. å˜—è©¦å¾ URL åƒæ•¸ç²å–
            const urlParams = new URLSearchParams(window.location.search);
            const dataParam = urlParams.get('data');
            
            if (dataParam) {
                try {
                    return JSON.parse(decodeURIComponent(dataParam));
                } catch (e) {
                    console.error('Failed to parse URL data:', e);
                }
            }
            
            // 2. å˜—è©¦å¾ sessionStorage ç²å–ï¼ˆupload.html å­˜å„²çš„åœ°æ–¹ï¼‰
            const sessionData = sessionStorage.getItem('sa_result');
            if (sessionData) {
                try {
                    return JSON.parse(sessionData);
                } catch (e) {
                    console.error('Failed to parse session data:', e);
                }
            }
            
            // 3. å˜—è©¦å¾ localStorage ç²å–
            const storedData = localStorage.getItem('ig_analysis_result');
            if (storedData) {
                try {
                    return JSON.parse(storedData);
                } catch (e) {
                    console.error('Failed to parse stored data:', e);
                }
            }
            
            // 4. å¦‚æœéƒ½æ²’æœ‰ï¼Œè¿”å› nullï¼ˆé¡¯ç¤ºéŒ¯èª¤æˆ–é‡å®šå‘ï¼‰
            return null;
        }

        // é é¢è¼‰å…¥æ™‚
        window.addEventListener('DOMContentLoaded', () => {
            const analysisData = getAnalysisData();
            
            if (analysisData && analysisData.ok) {
                // ä½¿ç”¨çœŸå¯¦çš„åˆ†ææ•¸æ“š
                setTimeout(() => {
                    renderResult(analysisData);
                }, 1500);
            } else {
                // æ²’æœ‰æ•¸æ“šï¼Œé¡¯ç¤ºéŒ¯èª¤æˆ–é‡å®šå‘åˆ°ä¸Šå‚³é é¢
                document.getElementById('loading').innerHTML = `
                    <div class="loading-spinner"></div>
                    <p>æœªæ‰¾åˆ°åˆ†æçµæœ</p>
                    <p style="margin-top: 20px; font-size: 14px;">
                        <a href="/static/upload.html" style="color: white; text-decoration: underline;">
                            é»æ­¤é‡æ–°ä¸Šå‚³åœ–ç‰‡é€²è¡Œåˆ†æ
                        </a>
                    </p>
                `;
            }
        });
  </script>
</body>
</html>